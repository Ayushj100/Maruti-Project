/*
 * Copyright 2024 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 */

import { environmentSelection } from '../commons/utility/masterUtil.js';

/* eslint-env browser */
window.hlx = window.hlx || {};

// Declare the blocks that are to be used from commons
window.hlx.commonsBlocks = ['cards', 'columns', 'fragment', 'hero', 'logo'];
window.hlx.sfBlocks = [
  'model-selection',
  'variant-detail',
  'user-profile',
  'personal-details',
  'price-summary',
  'pre-approved',
  'loan-compare',
  'filter-form',
  'login-page',
  'customer-detail',
  'dealer-list',
  'sf-journey-start',
  'loan-application',
  'loan-status',
  'loan-callback',
  'financier-mapping',
  'journey-carousel',
  'collapsible-text',
  'faq',
  'image-carousel',
  'sf-dealer-locator',
  'support-contact',
  'support-contact-list',
  'popup-block',
  'popup-block-list',
  'document-reupload',
  'popup-multi-language',
  'schema-block-sf',
  'disbursement-summary-report',
  'redirect-handler',
];
window.hlx.lcpBlocks = ['image-carousel', 'banner-carousel', 'car-detail-banner'];
window.hlx.ebookModuleBlocks = ['ebook-journey'];
window.hlx.corpBlocks = [
  'corp-header',
  'corp-carousel',
  'corp-carousel-item',
  'corp-counter',
  'corp-our-values',
  'corp-slider',
  'corp-slider-item',
  'corporate-business-card',
  'corporate-business-card-item',
  'corp-footer',
];

window.hlx.serviceBlocks = [
  'top-actions',
  'service-cost-calculator',
  'car-service-summary',
  'what-we-offer',
  'cancel-booking-service-dialog',
  'book-service-appointment-login',
  'service-banner',
  'service-about-us',
  'rewards-app-slider',
  'service-faq',
  'book-service-appointment',
  'find-a-workshop',
  'my-services',
  'add-address',
  'service-details',
  'cancel-booking-section',
  'booking-service-reschedule-dialog',
  'ocas',
  'ocas-cost-breakdown',
  'service-cost-summary',
  'diy',
  'bsa-fast-track',
  'ccp-video',
  'ew-plan-cards',
];

window.hlx.alloyConfig = {
  datastreamId: environmentSelection.getConfiguration('datastreamId'),
  profileEnabledDataStreamId: environmentSelection.getConfiguration('profileEnabledDataStreamId'),
  thirdPartyCookiesEnabled: false,
};

function setCodeBasePath() {
  window.hlx.codeBasePath = '';
  window.hlx.commonsCodeBasePath = '';
  const scriptEl = document.querySelector('script[src$="/scripts/init.js"]');
  if (scriptEl) {
    try {
      const scriptURL = new URL(scriptEl.src, window.location);
      if (scriptURL.host === window.location.host) {
        [window.hlx.codeBasePath] = scriptURL.pathname.split('/scripts/init.js');
      } else {
        [window.hlx.codeBasePath] = scriptURL.href.split('/scripts/init.js');
      }
      window.hlx.commonsCodeBasePath = `${window.hlx.codeBasePath}/commons`;
    } catch (error) {
      // eslint-disable-next-line no-console
      console.log(error);
    }
  }
}

window.hlx.apiDomainForLocalhost = 'https://dev-arena.marutisuzuki.com/';

setCodeBasePath();
